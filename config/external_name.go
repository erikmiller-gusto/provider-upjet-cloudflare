package config

import (
	"github.com/crossplane/upjet/v2/pkg/config"
)

// ExternalNameConfigs contains all external name configurations for this
// provider.
var ExternalNameConfigs = map[string]config.ExternalName{
	// Account & Organization Resources
	// Account is identified by its ID generated by Cloudflare
	"cloudflare_account": config.IdentifierFromProvider,
	// Account member uses a composite ID: account_id/member_id
	"cloudflare_account_member": config.IdentifierFromProvider,
	// Account token is identified by its ID
	"cloudflare_account_token": config.IdentifierFromProvider,
	// API token is identified by its ID
	"cloudflare_api_token": config.IdentifierFromProvider,

	// Zone & DNS Resources
	// Zone is identified by its ID (zone_id) generated by Cloudflare
	"cloudflare_zone": config.IdentifierFromProvider,
	// Zone settings use zone_id
	"cloudflare_zone_setting": config.IdentifierFromProvider,
	// Zone DNSSEC uses zone_id
	"cloudflare_zone_dnssec": config.IdentifierFromProvider,
	// Zone lockdown uses zone_id/lockdown_id
	"cloudflare_zone_lockdown": config.IdentifierFromProvider,
	// Zone hold uses zone_id
	"cloudflare_zone_hold": config.IdentifierFromProvider,
	// Zone cache reserve uses zone_id
	"cloudflare_zone_cache_reserve": config.IdentifierFromProvider,
	// Zone cache variants uses zone_id
	"cloudflare_zone_cache_variants": config.IdentifierFromProvider,
	// DNS record is identified by zone_id/record_id
	"cloudflare_dns_record": config.IdentifierFromProvider,
	// Backward compatibility - cloudflare_record is an alias
	"cloudflare_record": config.IdentifierFromProvider,
	// DNS settings
	"cloudflare_dns_settings": config.IdentifierFromProvider,

	// Custom Hostnames & SSL
	// Custom hostname uses zone_id/hostname_id
	"cloudflare_custom_hostname": config.IdentifierFromProvider,
	// Custom hostname fallback origin uses zone_id
	"cloudflare_custom_hostname_fallback_origin": config.IdentifierFromProvider,
	// Custom SSL uses zone_id/certificate_id
	"cloudflare_custom_ssl": config.IdentifierFromProvider,
	// Origin CA certificate uses certificate_id
	"cloudflare_origin_ca_certificate": config.IdentifierFromProvider,
	// Certificate pack uses zone_id/certificate_pack_id
	"cloudflare_certificate_pack": config.IdentifierFromProvider,
	// Keyless certificate
	"cloudflare_keyless_certificate": config.IdentifierFromProvider,
	// mTLS certificate
	"cloudflare_mtls_certificate": config.IdentifierFromProvider,
	// Total TLS
	"cloudflare_total_tls": config.IdentifierFromProvider,
	// Hostname TLS setting
	"cloudflare_hostname_tls_setting": config.IdentifierFromProvider,
	// Hostname TLS setting ciphers
	"cloudflare_hostname_tls_setting_ciphers": config.IdentifierFromProvider,
	// Authenticated origin pulls
	"cloudflare_authenticated_origin_pulls": config.IdentifierFromProvider,
	// Authenticated origin pulls certificate
	"cloudflare_authenticated_origin_pulls_certificate": config.IdentifierFromProvider,

	// Firewall & Security Resources
	// Filter uses zone_id/filter_id
	"cloudflare_filter": config.IdentifierFromProvider,
	// Firewall rule uses zone_id/firewall_rule_id
	"cloudflare_firewall_rule": config.IdentifierFromProvider,
	// Rate limit uses zone_id/rate_limit_id
	"cloudflare_rate_limit": config.IdentifierFromProvider,
	// WAF rule
	"cloudflare_waf_rule": config.IdentifierFromProvider,
	// WAF override
	"cloudflare_waf_override": config.IdentifierFromProvider,
	// WAF package
	"cloudflare_waf_package": config.IdentifierFromProvider,
	// Ruleset uses zone_id/ruleset_id or account_id/ruleset_id
	"cloudflare_ruleset": config.IdentifierFromProvider,
	// Managed headers
	"cloudflare_managed_headers": config.IdentifierFromProvider,
	// URL normalization settings
	"cloudflare_url_normalization_settings": config.IdentifierFromProvider,
	// User agent blocking rule
	"cloudflare_user_agent_blocking_rule": config.IdentifierFromProvider,
	// Page rule
	"cloudflare_page_rule": config.IdentifierFromProvider,
	// Bot management
	"cloudflare_bot_management": config.IdentifierFromProvider,
	// Leaked credential check
	"cloudflare_leaked_credential_check": config.IdentifierFromProvider,
	// Leaked credential check rule
	"cloudflare_leaked_credential_check_rule": config.IdentifierFromProvider,

	// Access Resources
	// Access application uses account_id/app_id or zone_id/app_id
	"cloudflare_access_application": config.IdentifierFromProvider,
	// Access policy uses account_id/app_id/policy_id or zone_id/app_id/policy_id
	"cloudflare_access_policy": config.IdentifierFromProvider,
	// Access group uses account_id/group_id or zone_id/group_id
	"cloudflare_access_group": config.IdentifierFromProvider,
	// Access identity provider
	"cloudflare_access_identity_provider": config.IdentifierFromProvider,
	// Access mutual TLS certificate
	"cloudflare_access_mutual_tls_certificate": config.IdentifierFromProvider,
	// Access rule uses identifier (account or zone level)
	"cloudflare_access_rule": config.IdentifierFromProvider,
	// Access service token
	"cloudflare_access_service_token": config.IdentifierFromProvider,
	// Access CA certificate
	"cloudflare_access_ca_certificate": config.IdentifierFromProvider,
	// Access keys configuration
	"cloudflare_access_keys_configuration": config.IdentifierFromProvider,
	// Access organization
	"cloudflare_access_organization": config.IdentifierFromProvider,
	// Access tag
	"cloudflare_access_tag": config.IdentifierFromProvider,
	// Access custom page
	"cloudflare_access_custom_page": config.IdentifierFromProvider,
	// Access bookmark
	"cloudflare_access_bookmark": config.IdentifierFromProvider,

	// Zero Trust Resources
	// Zero Trust list (formerly Teams list)
	"cloudflare_zero_trust_list": config.IdentifierFromProvider,
	// Zero Trust gateway policy
	"cloudflare_zero_trust_gateway_policy": config.IdentifierFromProvider,
	// Zero Trust gateway settings
	"cloudflare_zero_trust_gateway_settings": config.IdentifierFromProvider,
	// Zero Trust tunnel (Cloudflared)
	"cloudflare_zero_trust_tunnel_cloudflared": config.IdentifierFromProvider,
	// Zero Trust tunnel config
	"cloudflare_zero_trust_tunnel_cloudflared_config": config.IdentifierFromProvider,
	// Zero Trust tunnel route
	"cloudflare_zero_trust_tunnel_route": config.IdentifierFromProvider,
	// Zero Trust device posture rule
	"cloudflare_zero_trust_device_posture_rule": config.IdentifierFromProvider,
	// Zero Trust device posture integration
	"cloudflare_zero_trust_device_posture_integration": config.IdentifierFromProvider,
	// Zero Trust device profiles
	"cloudflare_zero_trust_device_profiles": config.IdentifierFromProvider,
	// Zero Trust device managed networks
	"cloudflare_zero_trust_device_managed_networks": config.IdentifierFromProvider,
	// Zero Trust device certificates
	"cloudflare_zero_trust_device_certificates": config.IdentifierFromProvider,
	// Zero Trust DEX test
	"cloudflare_zero_trust_dex_test": config.IdentifierFromProvider,
	// Zero Trust DLP profile
	"cloudflare_zero_trust_dlp_profile": config.IdentifierFromProvider,
	// Zero Trust DLP custom profile
	"cloudflare_zero_trust_dlp_custom_profile": config.IdentifierFromProvider,
	// Zero Trust DLP entry
	"cloudflare_zero_trust_dlp_entry": config.IdentifierFromProvider,
	// Zero Trust DLP custom entry
	"cloudflare_zero_trust_dlp_custom_entry": config.IdentifierFromProvider,
	// Zero Trust risk behavior
	"cloudflare_zero_trust_risk_behavior": config.IdentifierFromProvider,
	// Zero Trust risk scoring integration
	"cloudflare_zero_trust_risk_scoring_integration": config.IdentifierFromProvider,
	// Zero Trust access short lived certificate
	"cloudflare_zero_trust_access_short_lived_certificate": config.IdentifierFromProvider,
	// Zero Trust gateway certificate
	"cloudflare_zero_trust_gateway_certificate": config.IdentifierFromProvider,
	// Zero Trust local domain fallback
	"cloudflare_zero_trust_local_domain_fallback": config.IdentifierFromProvider,
	// Zero Trust split tunnel
	"cloudflare_zero_trust_split_tunnel": config.IdentifierFromProvider,

	// Teams Resources (legacy naming, being replaced by Zero Trust)
	"cloudflare_teams_account":        config.IdentifierFromProvider,
	"cloudflare_teams_list":           config.IdentifierFromProvider,
	"cloudflare_teams_location":       config.IdentifierFromProvider,
	"cloudflare_teams_proxy_endpoint": config.IdentifierFromProvider,
	"cloudflare_teams_rule":           config.IdentifierFromProvider,
	"cloudflare_fallback_domain":      config.IdentifierFromProvider,
	"cloudflare_split_tunnel":         config.IdentifierFromProvider,

	// Load Balancing Resources
	// Load balancer uses zone_id/lb_id
	"cloudflare_load_balancer": config.IdentifierFromProvider,
	// Load balancer pool uses account_id/pool_id
	"cloudflare_load_balancer_pool": config.IdentifierFromProvider,
	// Load balancer monitor uses account_id/monitor_id
	"cloudflare_load_balancer_monitor": config.IdentifierFromProvider,

	// Workers & Pages Resources
	// Workers script is identified by script name
	"cloudflare_workers_script": config.NameAsIdentifier,
	// Worker route uses zone_id/route_id
	"cloudflare_worker_route": config.IdentifierFromProvider,
	// Worker cron trigger
	"cloudflare_worker_cron_trigger": config.IdentifierFromProvider,
	// Worker domain
	"cloudflare_worker_domain": config.IdentifierFromProvider,
	// Worker secret
	"cloudflare_worker_secret": config.IdentifierFromProvider,
	// Workers for Platforms namespace - name is the identifier
	"cloudflare_workers_for_platforms_namespace": config.NameAsIdentifier,
	// Workers KV (key-value pair)
	"cloudflare_workers_kv": config.IdentifierFromProvider,
	// Workers KV namespace - title is the identifier
	"cloudflare_workers_kv_namespace": config.NameAsIdentifier,
	// Pages project - name is the identifier
	"cloudflare_pages_project": config.NameAsIdentifier,
	// Pages domain
	"cloudflare_pages_domain": config.IdentifierFromProvider,

	// R2 Storage Resources
	// R2 bucket - name is the identifier
	"cloudflare_r2_bucket": config.NameAsIdentifier,
	// R2 custom domain
	"cloudflare_r2_custom_domain": config.IdentifierFromProvider,
	// R2 managed domain
	"cloudflare_r2_managed_domain": config.IdentifierFromProvider,
	// R2 bucket lock
	"cloudflare_r2_bucket_lock": config.IdentifierFromProvider,
	// R2 bucket lifecycle
	"cloudflare_r2_bucket_lifecycle": config.IdentifierFromProvider,
	// R2 bucket CORS
	"cloudflare_r2_bucket_cors": config.IdentifierFromProvider,
	// R2 bucket Sippy
	"cloudflare_r2_bucket_sippy": config.IdentifierFromProvider,

	// Argo & Routing Resources
	// Argo settings
	"cloudflare_argo": config.IdentifierFromProvider,
	// Argo tunnel (deprecated, use zero_trust_tunnel)
	"cloudflare_argo_tunnel": config.IdentifierFromProvider,
	// Tiered cache
	"cloudflare_tiered_cache": config.IdentifierFromProvider,
	// Regional tiered cache
	"cloudflare_regional_tiered_cache": config.IdentifierFromProvider,
	// Static route
	"cloudflare_static_route": config.IdentifierFromProvider,
	// GRE tunnel
	"cloudflare_gre_tunnel": config.IdentifierFromProvider,
	// IPsec tunnel
	"cloudflare_ipsec_tunnel": config.IdentifierFromProvider,

	// Magic WAN Resources
	"cloudflare_magic_firewall_ruleset": config.IdentifierFromProvider,
	"cloudflare_magic_wan_gre_tunnel":   config.IdentifierFromProvider,
	"cloudflare_magic_wan_ipsec_tunnel": config.IdentifierFromProvider,
	"cloudflare_magic_wan_static_route": config.IdentifierFromProvider,

	// Spectrum Resources
	"cloudflare_spectrum_application": config.IdentifierFromProvider,

	// Logging Resources
	// Logpush job uses zone_id/job_id or account_id/job_id
	"cloudflare_logpush_job": config.IdentifierFromProvider,
	// Logpull retention
	"cloudflare_logpull_retention": config.IdentifierFromProvider,

	// Notification Resources
	"cloudflare_notification_policy":          config.IdentifierFromProvider,
	"cloudflare_notification_policy_webhooks": config.IdentifierFromProvider,

	// Healthcheck Resources
	"cloudflare_healthcheck": config.IdentifierFromProvider,

	// Waiting Room Resources
	"cloudflare_waiting_room":          config.IdentifierFromProvider,
	"cloudflare_waiting_room_event":    config.IdentifierFromProvider,
	"cloudflare_waiting_room_rules":    config.IdentifierFromProvider,
	"cloudflare_waiting_room_settings": config.IdentifierFromProvider,

	// Web3 Resources
	"cloudflare_web3_hostname": config.IdentifierFromProvider,

	// Stream Resources
	"cloudflare_stream":             config.IdentifierFromProvider,
	"cloudflare_stream_key":         config.IdentifierFromProvider,
	"cloudflare_stream_live_input":  config.IdentifierFromProvider,
	"cloudflare_stream_webhook":     config.IdentifierFromProvider,
	"cloudflare_stream_audio_track": config.IdentifierFromProvider,
	"cloudflare_stream_caption":     config.IdentifierFromProvider,
	"cloudflare_stream_download":    config.IdentifierFromProvider,
	"cloudflare_stream_watermark":   config.IdentifierFromProvider,

	// Email Routing Resources
	"cloudflare_email_routing_address":   config.IdentifierFromProvider,
	"cloudflare_email_routing_catch_all": config.IdentifierFromProvider,
	"cloudflare_email_routing_dns":       config.IdentifierFromProvider,
	"cloudflare_email_routing_rule":      config.IdentifierFromProvider,
	"cloudflare_email_routing_settings":  config.IdentifierFromProvider,

	// List Resources (IP Lists, etc.)
	// List uses account_id/list_id
	"cloudflare_list": config.IdentifierFromProvider,
	// List item uses account_id/list_id/item_id
	"cloudflare_list_item": config.IdentifierFromProvider,

	// API Shield Resources
	"cloudflare_api_shield":                                      config.IdentifierFromProvider,
	"cloudflare_api_shield_operation":                            config.IdentifierFromProvider,
	"cloudflare_api_shield_schema":                               config.IdentifierFromProvider,
	"cloudflare_api_shield_operation_schema_validation_settings": config.IdentifierFromProvider,
	"cloudflare_api_shield_schema_validation_settings":           config.IdentifierFromProvider,

	// Address Map & BYO IP Resources
	"cloudflare_address_map":   config.IdentifierFromProvider,
	"cloudflare_byo_ip_prefix": config.IdentifierFromProvider,

	// Regional Hostname
	"cloudflare_regional_hostname": config.IdentifierFromProvider,

	// Snippet Resources
	"cloudflare_snippet":       config.IdentifierFromProvider,
	"cloudflare_snippet_rules": config.IdentifierFromProvider,

	// Turnstile Widget
	"cloudflare_turnstile_widget": config.IdentifierFromProvider,

	// Web Analytics Resources
	"cloudflare_web_analytics_site": config.IdentifierFromProvider,
	"cloudflare_web_analytics_rule": config.IdentifierFromProvider,

	// Queue Resources
	// Queue - name is the identifier
	"cloudflare_queue":          config.NameAsIdentifier,
	"cloudflare_queue_consumer": config.IdentifierFromProvider,

	// Hyperdrive Resources
	// Hyperdrive config - name is the identifier
	"cloudflare_hyperdrive_config": config.NameAsIdentifier,

	// AI Gateway Resources
	"cloudflare_ai_gateway": config.IdentifierFromProvider,

	// AI Search Resources (new in v5.15.0)
	"cloudflare_ai_search": config.IdentifierFromProvider,

	// D1 Database Resources
	// D1 database - name is the identifier
	"cloudflare_d1_database": config.NameAsIdentifier,

	// Infrastructure Access Resources
	"cloudflare_infrastructure_access_target": config.IdentifierFromProvider,

	// Observatory Resources
	"cloudflare_observatory_scheduled_test": config.IdentifierFromProvider,

	// DNS Firewall Resources
	"cloudflare_account_dns_firewall_cluster": config.IdentifierFromProvider,
	"cloudflare_dns_firewall":                 config.IdentifierFromProvider,

	// Cloudforce One Resources (new in v5.x)
	"cloudflare_cloudforce_one_request":          config.IdentifierFromProvider,
	"cloudflare_cloudforce_one_request_asset":    config.IdentifierFromProvider,
	"cloudflare_cloudforce_one_request_message":  config.IdentifierFromProvider,
	"cloudflare_cloudforce_one_request_priority": config.IdentifierFromProvider,

	// Images Resources
	"cloudflare_images_variant": config.IdentifierFromProvider,

	// Calls Resources
	"cloudflare_calls_sfu_app":  config.IdentifierFromProvider,
	"cloudflare_calls_turn_app": config.IdentifierFromProvider,

	// Vectorize Resources
	"cloudflare_vectorize_index": config.NameAsIdentifier,

	// Browser Isolation Resources
	"cloudflare_browser_isolation_banner":      config.IdentifierFromProvider,
	"cloudflare_browser_isolation_certificate": config.IdentifierFromProvider,
	"cloudflare_browser_isolation_permissions": config.IdentifierFromProvider,

	// Content Scanning Resources
	"cloudflare_content_scanning":            config.IdentifierFromProvider,
	"cloudflare_content_scanning_expression": config.IdentifierFromProvider,

	// Cloud Connector Resources
	"cloudflare_cloud_connector_rules": config.IdentifierFromProvider,

	// Zaraz Resources
	"cloudflare_zaraz_config":           config.IdentifierFromProvider,
	"cloudflare_zaraz_default_config":   config.IdentifierFromProvider,
	"cloudflare_zaraz_history_settings": config.IdentifierFromProvider,
	"cloudflare_zaraz_workflow":         config.IdentifierFromProvider,

	// Web Application Firewall Package/Group Resources
	"cloudflare_waf_group": config.IdentifierFromProvider,

	// Cache Resources
	"cloudflare_cache_rule":    config.IdentifierFromProvider,
	"cloudflare_cache_reserve": config.IdentifierFromProvider,

	// Hostname Resources
	"cloudflare_custom_hostname_certificate_pack": config.IdentifierFromProvider,

	// Device Dex Resources (Zero Trust)
	"cloudflare_zero_trust_device_dex_test": config.IdentifierFromProvider,

	// Additional DNS Resources
	"cloudflare_secondary_dns_primary_zone":   config.IdentifierFromProvider,
	"cloudflare_secondary_dns_secondary_zone": config.IdentifierFromProvider,
	"cloudflare_secondary_dns_tsig":           config.IdentifierFromProvider,

	// SSL/TLS Resources
	"cloudflare_ssl_recommendation": config.IdentifierFromProvider,

	// Rate Limiting Resources (new version)
	"cloudflare_rate_limiting_rule": config.IdentifierFromProvider,
}

// ExternalNameConfigurations applies all external name configs listed in the
// table ExternalNameConfigs and sets the version of those resources to v1beta1
// assuming they will be tested.
func ExternalNameConfigurations() config.ResourceOption {
	return func(r *config.Resource) {
		if e, ok := ExternalNameConfigs[r.Name]; ok {
			r.ExternalName = e
		}
	}
}

// ExternalNameConfigured returns the list of all resources whose external name
// is configured manually.
func ExternalNameConfigured() []string {
	l := make([]string, len(ExternalNameConfigs))
	i := 0
	for name := range ExternalNameConfigs {
		// $ is added to match the exact string since the format is regex.
		l[i] = name + "$"
		i++
	}
	return l
}
